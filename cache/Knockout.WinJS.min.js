var WinJS;!function(a){!function(b){function c(b,c,d){var e=a.Binding.converter(function(a){return a?"":"none"});return e(b,c,d,["style","display"])}function d(b,c,d,e){var f=d.winControl;return f||"WinJS.KO.FlowControl"!=d.getAttribute("data-win-control")||(f=new a.KO.FlowControl(d)),f?(f.type=e,f.source=b,a.Binding.defaultBind(b,c,d,["winControl","data"])):{cancel:function(){}}}function e(a,b,c){return d(a,b,c,"foreach")}function f(a,b,c){return d(a,b,c,"with")}function g(a,b,c){return d(a,b,c,"if")}function h(a,b,c){return d(a,b,c,"ifnot")}function i(b,c,d,e){function f(a,b){a=a||{};for(var c in a){var d=a[c];"function"==typeof d&&b(c)}}function g(){f(d._winjs_ko_eventBind,function(a){d.removeEventListener(a,h)})}function h(a){var b=d._winjs_ko_eventBind[a.type];!0!==b.apply(i,[i,a])&&a.preventDefault()}var i=w.isObservableDataContext(b)?a.Binding.unwrap(b.$data):b,j=a.Binding.converter(function(a){var b=e(a)||{};return g(),f(b,function(a){d.addEventListener(a,h)}),b}),k=j(b,c,d,["_winjs_ko_eventBind"]);return{cancel:function(){k.cancel(),g()}}}function j(a,b,c){return i(a,b,c,function(a){return{click:a}})}function k(a,b,c){return i(a,b,c,function(a){return a})}function l(a,b,c){return i(a,b,c,function(a){return{submit:a}})}function m(b,c,d){var e=a.Binding.converter(function(a){return!a});return e(b,c,d,["disabled"])}function n(b,c,d){var e=a.Binding.defaultBind(b,c,d,["value"]);return r(b)&&(d.oninput=function(){s(b,c,d.value)}),{cancel:function(){e.cancel(),d.oninput=null}}}function o(b,c,d){function e(a){return a.ownerDocument.activeElement==a}var f=a.Binding.converter(function(a){var f=e(d);return a!=f&&(a?d.focus():d.blur()),r(b)&&(d.onfocus=d.onblur=function(){s(b,c,e(d))}),a}),g=f(b,c,d,["_winjs_ko_hasFocus"]);return{cancel:function(){g.cancel(),d.onfocus=d.onblur=null}}}function p(b,c,d){function e(b){return"INPUT"!=d.tagName||"checkbox"!=d.type&&"radio"!=d.type?!1:"checkbox"==d.type&&(b instanceof Array||b instanceof a.Binding.List)?b.indexOf(d.value)>=0:"radio"==d.type&&"string"==typeof b?b==d.value:b}var f,g=a.Binding.converter(function(b){return f&&(b.unbind("_array",f),f=void 0),a.KO.isObservableArray(b)&&(f=function(){d.checked=e(b)},b.bind("_array",f)),e(b)}),h=g(b,c,d,["checked"]);return r(b)&&(d.onchange=function(){s(b,c,d.checked,function(b,c){if("checkbox"==d.type&&(c instanceof Array||c instanceof a.Binding.List)){var e=c.indexOf(d.value);return b&&0>e?c.push(d.value):!b&&e>=0&&c.splice(e,1),c}return"radio"==d.type&&"string"==typeof c?b?d.value:c==d.value?void 0:c:b})}),{cancel:function(){h.cancel(),d.onchange=null}}}function q(b,c,e){var f=document.createElement("div");f.innerHTML='<option data-win-bind="textContent : $data WinJS.KO.defaultBind"/>';var g=new a.Binding.Template(f);return new a.KO.FlowControl(e,{template:g}),d(b,c,e,"foreach")}function r(b){return a.Binding.unwrap(b)!==b}function s(a,b,c,d){for(var e=0,f=b.length-1;f>e;e++)if(a=a[b[e]],!a)return;var g=b[b.length-1];d&&(c=d(c,a[g])),a[g]=c}var t={$foreach:e,$if:g,$ifnot:h,$with:f,$event:k,$click:j,$submit:l,$value:n,$checked:p,$hasFocus:o,$visible:c,$enabled:m,$options:q};b.defaultBind=a.Binding.initializer(function(b,c,d,e){var f=b;if(e.length>0&&v[c[0]]){var g=w.getDataContextFromElement(d);g&&(f=g)}if(e||1==e.length){var h=e[0];if(t[h])return t[h](f,c,d)}return a.Binding.defaultBind(f,c,d,e)});var u=function(){function b(b,c){function d(b){var c=document.createElement("div");c.innerHTML=b.innerHTML;for(var d=b.querySelectorAll("[data-win-bind]"),e=0;e<d.length;e++)d.item(e).attributes.removeNamedItem("data-win-bind");for(;b.hasChildNodes();)b.removeChild(b.lastChild);var f=new a.Binding.Template(c);return f.bindingInitializer=a.KO.defaultBind,c.isDeclarativeControlContainer=!0,f}this.dispose=function(){this._disposeChildren()},c=c||{},b.winControl||(this._data=c.data,this._template=c.template||d(b),this._type=c.type,this._source=c.source,this.element=b,b.winControl=this,this.reload())}return b.prototype.reload=function(){var b=this,c=function(a,c,d,e){var f=document.createElement("div");if(c){var g=w.createObservableDataContext(a,d);arguments.length>=4&&g.addProperty("$index",e),f._winjs_ko_dataContext=g}if(a&&b._template.render(a,f),1==f.childElementCount){var h=f.firstElementChild;return f.removeChild(f.firstElementChild),h._winjs_ko_dataContext=g,h}return f},d=function(a,d,e){var f=c(a,d,e);b.element.appendChild(f)};if(this._disposeChildren(),this._template)switch(this._type){case"if":this._data&&d(this._source,!1);break;case"ifnot":this._data||d(this._source,!1);break;case"with":d(this._data,!0,this._source);break;case"foreach":var e=this._source,f=function(d){if(d instanceof Array||d instanceof a.Binding.List){var f=d.map(function(a,d){for(var f=b.element.firstChild;f&&f._winjs_ko_dataItem!=a;)f=f.nextSibling;return f?b.element.removeChild(f):(f=c(a,!0,e,d),f._winjs_ko_dataItem=a),f});b._disposeChildren(),f.forEach(function(a,c){a._winjs_ko_dataContext.$index=c,b.element.appendChild(a)})}};a.KO.isObservableArray(this._data)?this._data.bind("_array",f):f(this._data)}},Object.defineProperty(b.prototype,"data",{get:function(){return this._data},set:function(a){a!==this._data&&(this._data=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"template",{get:function(){return this._template},set:function(a){a!==this._template&&(this._template=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"type",{get:function(){return this.type},set:function(a){a!==this._type&&(this._type=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"source",{get:function(){return this._source},set:function(a){a!==this._source&&(this._source=a,this.reload())},enumerable:!0,configurable:!0}),b.prototype._disposeChildren=function(){for(;this.element.childElementCount>0;){var a=this.element.lastElementChild;"function"==typeof a.dispose&&a.dispose();var b=a._winjs_ko_dataContext;b&&"function"==typeof b.dispose&&b.dispose(),this.element.removeChild(a)}},b.cctor=function(){a.Utilities.markSupportedForProcessing(b),b.isDeclarativeControlContainer=!0}(),b}();b.FlowControl=u;var v={$parent:!0,$parents:!0,$root:!0,$data:!0,$index:!0,$parentContext:!0,$rawData:!0,$element:!0,$context:!0},w=function(){function c(){}return c.prototype.data=function(b){this.$data=b,this.$rawData=b instanceof a.Binding.List?a.KO.getRawArray(b):a.Binding.unwrap(b)},c.isObservableDataContext=function(b){return b&&a.Binding.unwrap(b)instanceof c},c.getDataContextFromElement=function(a){for(var b=a;b&&!c.isObservableDataContext(b._winjs_ko_dataContext);)b=b.parentElement;return b?b._winjs_ko_dataContext:null},c.createObservableDataContext=function(a,d){var e=new c;e.data(a),d?(e.$parentContexts=[d],e.$parentContext=d):e.$parentContexts=[];var f=b.observable(e);return c.isObservableDataContext(d)?(e.$parentContexts.concat(d.$parentContexts),f.addComputedProperty("$parents",function(){return f.peek("$parentContexts").map(function(a){return a.$data})}),f.addComputedProperty("$parent",function(){return f.peek("$parentContext").$data}),f.addComputedProperty("$root",function(){var a=f.peek("$parentContexts");return a.length>0?a[a.length-1].$data:void 0})):(f.$parents=[d],f.$parent=d,f.$root=d),f},c}();!function(){a.Utilities.markSupportedForProcessing(b.defaultBind)}()}(a.KO||(a.KO={}));a.KO}(WinJS||(WinJS={}));var WinJS;!function(a){!function(b){function c(b){function c(){d=new l;var a=f._array;f._array=e(f),f.notify("_array",f._array,a)}var d,b=b||[],f=new a.Binding.List(b);return f.addEventListener("itemchanged",c),f.addEventListener("iteminserted",c),f.addEventListener("itemmoved",c),f.addEventListener("itemmutated",c),f.addEventListener("itemremoved",c),f.addEventListener("reload",c),f._lastUpdatedStamp=function(){return d},f._array=e(f),Object.defineProperty(f,"array",{get:function(){var a=k.currentContext();return a&&g(f,"_array"),f._array},enumerable:!0,configurable:!0}),f}function d(b){return b instanceof a.Binding.List&&b._array instanceof Array}function e(b){return b instanceof a.Binding.List?b.map(function(a){return a}):void 0}function f(a){a.addComputedProperty=function(a,c,d,e){this.addProperty(a),b.computed(c,d,e,this,a)};var c=a.getProperty;a.getProperty=function(a){return g(this,a),c.call(this,a)};var d=a.updateProperty;a.updateProperty=function(a,b,c){this._lastUpdatedStamp(a,c||l.newStamp()),d.call(this,a,b)};var e=a.setProperty;a.setProperty=function(a,b){var c=this._computedProperty(a);if(c){if(c._computedWriter)return void c._computedWriter(b);throw new Error("Cannot write a value to a computed observable property unless you specify a 'write' option.")}return e.call(this,a,b)},a._removeAllDependencies=function(a){var b=this._computedProperty(a);if(b){var c=b._dependencies||[];c.forEach(function(a){a._observable.unbind(a._propertyName,b._computedUpdater)}),b._dependencies=[]}};var f=a.dispose;a.dispose=function(a){var b=this;if(arguments.length>0){var c=this._computedProperty(a);c&&(c._removeAllDependencies(),c._computedUpdater=null,c._computedWriter=null,delete this._computedProperties[a])}else f&&f.call(this),Object.keys(this).forEach(function(a){b.dispose(a)})},a._lastUpdatedStamps={},a._lastUpdatedStamp=function(a,b){return this._lastUpdatedStamps=this._lastUpdatedStamps||{},1==arguments.length?this._lastUpdatedStamps[a]:void(arguments.length>1&&(this._lastUpdatedStamps[a]=b))},a._computedProperties={},a._computedProperty=function(a){return this._computedProperties[a]},a.peek=function(a){return c.call(this,a)},a.computed=function(a,c,d,e){b.computed(c,d,e,this,a)},a.getDependenciesCount=function(a){var b=this._computedProperty(a);return b&&b._dependencies?b._dependencies.length:0}}function g(a,b){var c=k.currentContext();if(c&&c.type==j.TYPE_COMPUTED_EVALUATIOR){var d=c.observableProperty;if(!d||d._observable===a&&d._propertyName==b)return;var e=d._observable._computedProperty(d._propertyName),f=new h(a,b),g=e._dependencies||[];g.some(function(a){return a===f})||g.push(f),e._dependencies=g}}b.observable=function(b){var c="object"==typeof b?b:new m(b);if(c){var d=a.Binding.as(c);return f(d),d}return c},b.computed=function(a,c,d,e,f){var g=a;if(a&&"object"==typeof a?(d=a||{},g=d.read):(d=d||{},g||(g=d.read)),"function"!=typeof g)throw new Error("Pass a function that returns the value of the computed function.");var m,n;e?(m=e,n=f):(m=b.observable(0),n="value"),c=c||d.owner||m;var o,p=function(){return g.call(c)};m.dispose&&m.dispose(n);var q=new i;m._computedProperties[n]=q;var r=function(){var a=k.currentContext();if(!a||a.type!=j.TYPE_COMPUTED_DEPENDENCY_BIND){q._removeAllDependencies();var b;k.execute(new j(j.TYPE_COMPUTED_EVALUATIOR,new h(m,n)),function(){b=p()});var c=q._dependencies||[];k.execute(new j(j.TYPE_COMPUTED_DEPENDENCY_BIND),function(){c.forEach(function(a){a._observable.bind(a._propertyName,r)})});var d=new l(new Date(0));if(c.forEach(function(a){var b=a._observable._lastUpdatedStamp(a._propertyName);b&&d.lessThan(b)&&(d=b)}),m._lastUpdatedStamp){var e=m._lastUpdatedStamp(n);(!e||e.lessThan(d))&&m.updateProperty(n,b,d)}else m[n]=b;return b}},s=d.write;s&&"function"==typeof s&&(q._computedWriter=function(a){s.call(c,a)}),q._computedUpdater=r,"function"==typeof m._lastUpdatedStamp&&m._lastUpdatedStamp(n,null);r();return m==e?o:m},b.observableArray=c,b.isObservableArray=d,b.getRawArray=e;var h=function(){function a(a,b){this._observable=a,this._propertyName=b}return a}(),i=function(){function a(){this._dependencies=[]}return a.prototype._removeAllDependencies=function(){var a=this._computedUpdater;this._dependencies.forEach(function(b){b._observable.unbind(b._propertyName,a)}),this._dependencies=[]},a}(),j=function(){function a(b,c){this.type=b,b==a.TYPE_COMPUTED_EVALUATIOR?this.observableProperty=c:this.upateStamp=c}return a.TYPE_COMPUTED_EVALUATIOR=0,a.TYPE_COMPUTED_DEPENDENCY_BIND=1,a.TYPE_WRITER_INITIAL_RUN=2,a.COMPUTED_WRITER=3,a}(),k=function(){function a(){}return a.execute=function(b,c){try{var d=a._currentContext;a._currentContext=b,c()}finally{a._currentContext=d}},a.currentContext=function(){return a._currentContext},a.contextStack=[],a}(),l=function(){function a(a,b){this.timeStamp=a||new Date,this.index=b||0}return a.prototype.lessThan=function(a){return this.timeStamp<a.timeStamp||this.timeStamp<a.timeStamp&&this.index<a.index},a.newStamp=function(){var b=new a;return b.timeStamp==a._lastUpdateStamp.timeStamp&&b.index==a._lastUpdateStamp.index+1,a._lastUpdateStamp=new a(b.timeStamp,b.index),b},a._lastUpdateStamp=new a,a}(),m=function(){function a(a){this.value=a}return a}()}(a.KO||(a.KO={}));a.KO}(WinJS||(WinJS={}));