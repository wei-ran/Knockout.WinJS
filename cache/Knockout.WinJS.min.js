var WinJS;!function(a){!function(b){function c(b,c,d){var e=a.Binding.converter(function(a){return a?"":"none"});return e(b,c,d,["style","display"])}function d(b,c,d){return a.Binding.defaultBind(b,c,d,["textContent"])}function e(b,c,d){return a.Binding.defaultBind(b,c,d,["innerHTML"])}function f(b,c,d,e){var f=d.winControl;return f||"WinJS.KO.FlowControl"!=d.getAttribute("data-win-control")||(f=new a.KO.FlowControl(d)),f?(f.type=e,f.source=b,a.Binding.defaultBind(b,c,f,["data"])):{cancel:function(){}}}function g(a,b,c){return f(a,b,c,"foreach")}function h(a,b,c){return f(a,b,c,"with")}function i(a,b,c){return f(a,b,c,"if")}function j(a,b,c){return f(a,b,c,"ifnot")}function k(b,c,d){return a.Binding.defaultBind(b,c,d,["onclick"])}function l(b,c,d){var e,f=function(a){e&&!e(a)&&a.preventDefault()};d.addEventListener("submit",f);var g=a.Binding.converter(function(a){return e="function"==typeof a?a:null}),h=g(b,c,d,["_winjs_ko_submitBind"]);return{cancel:function(){h.cancel(),d.removeEventListener("submit",f)}}}function m(b,c,d){var e=a.Binding.converter(function(a){return!a});return e(b,c,d,["disabled"])}function n(b,c,d){var e=a.Binding.defaultBind(b,c,d,["value"]);return q(b)&&(d.oninput=function(){r(b,c,d.value)}),{cancel:function(){e.cancel(),d.oninput=null}}}function o(b,c,d){function e(a){return a.ownerDocument.activeElement==a}var f=a.Binding.converter(function(a){var f=e(d);return a!=f&&(a?d.focus():d.blur()),q(b)&&(d.onfocus=d.onblur=function(){r(b,c,e(d))}),a}),g=f(b,c,d,["_winjs_ko_hasFocus"]);return{cancel:function(){g.cancel(),d.onfocus=d.onblur=null}}}function p(b,c,d){var e=a.Binding.defaultBind(b,c,d,["checked"]);return q(b)&&(d.onchange=function(){r(b,c,d.checked)}),{cancel:function(){e.cancel(),d.onchange=null}}}function q(b){return a.Binding.unwrap(b)!==b}function r(a,b,c){for(var d=0,e=b.length-1;e>d;d++)if(a=a[b[d]],!a)return;var f=b[b.length-1];a[f]=c}var s={visible:c,text:d,html:e,click:k,submit:l,enable:m,hasFocus:o,value:n,checked:p,$foreach:g,$with:h,$if:i,$ifnot:j};b.defaultBind=a.Binding.initializer(function(b,c,d,e){var f=b;if(e.length>0&&u[c[0]]){var g=v.getDataContextFromElement(d);g&&g.bindable&&(f=g.bindable())}if(e||1==e.length){var h=e[0];if(s[h])return s[h](f,c,d)}return a.Binding.defaultBind(b,c,d,e)});var t=function(){function b(b,c){function d(b){var c=document.createElement("div");c.innerHTML=b.innerHTML;for(var d=b.querySelectorAll("[data-win-bind]"),e=0;e<d.length;e++)d.item(e).attributes.removeNamedItem("data-win-bind");for(;b.hasChildNodes();)b.removeChild(b.lastChild);var f=new a.Binding.Template(c);return f.bindingInitializer=a.KO.defaultBind,c.isDeclarativeControlContainer=!0,f}this.dispose=function(){this._disposeChildren()},c=c||{},b.winControl||(this._data=c.data,this._template=c.tempate||d(b),this._type=c.type,this._source=c.source,this.element=b,this._parentContext=v.getDataContextFromElement(this.element),b.winControl=this,this.reload())}return b.prototype.reload=function(){var b=this,c=function(a,c,d,e){var f=document.createElement("div");if(c){var g=v.createObservableDataContext(a,d);arguments.length>=4&&g.addProperty("$index",e),f._winjs_ko_dataContext=g}return a&&b._template.render(a,f),f},d=function(a,d,e){var f=c(a,d,e);b.element.appendChild(f)};if(this._disposeChildren(),this._template)switch(this._type){case"if":this._data&&d(this._source,!1);break;case"ifnot":this._data||d(this._source,!1);break;case"with":d(this._data,!0,this._parentContext);break;case"foreach":var e=v.createObservableDataContext(this._data,this._parentContext),f=function(d){if(d instanceof Array||d instanceof a.Binding.List){var f=d.map(function(a,d){for(var f=b.element.firstChild;f&&f._winjs_ko_dataItem!=a;)f=f.nextSibling;return f?b.element.removeChild(f):(f=c(a,!0,e,d),f._winjs_ko_dataItem=a),f});b._disposeChildren(),f.forEach(function(a,c){a._winjs_ko_dataContext.$index(c),b.element.appendChild(a)})}};this._data instanceof a.Binding.List&&this._data._array instanceof Array?this._data.bind("_array",f):f(this._data)}},Object.defineProperty(b.prototype,"data",{get:function(){return this._data},set:function(a){a!==this._data&&(this._data=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"template",{get:function(){return this._template},set:function(a){a!==this._template&&(this._template=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"type",{get:function(){return this.type},set:function(a){a!==this._type&&(this._type=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"source",{get:function(){return this._source},set:function(a){a!==this._source&&(this._source=a,this.reload())},enumerable:!0,configurable:!0}),b.prototype._disposeChildren=function(){for(;this.element.childElementCount>0;){var a=this.element.lastElementChild;"function"==typeof a.dispose&&a.dispose();var b=a._winjs_ko_dataContext;b&&"function"==typeof b.dispose&&b.dispose(),this.element.removeChild(a)}},b.cctor=function(){a.Utilities.markSupportedForProcessing(b),b.isDeclarativeControlContainer=!0}(),b}();b.FlowControl=t;var u={$parent:!0,$parents:!0,$root:!0,$data:!0,$index:!0,$parentContext:!0,$rawData:!0,$element:!0,$context:!0},v=function(){function c(){}return c.prototype.data=function(b){this.$data=b,this.$rawData=b instanceof a.Binding.List?a.KO.getRawArray(b):a.Binding.unwrap(b)},c.isObservableDataContext=function(b){return b&&b.bindable&&a.Binding.unwrap(b.bindable())instanceof c},c.getDataContextFromElement=function(a){for(var b=a;b&&!c.isObservableDataContext(b._winjs_ko_dataContext);)b=b.parentElement;return b?b._winjs_ko_dataContext:null},c.createObservableDataContext=function(a,d){var e=new c;e.data(a),d?(e.$parentContexts=[d],e.$parentContexts.concat(d.$parentContexts()),e.$parentContext=d):e.$parentContexts=[];var f=b.observable(e);return d?(f.addComputedProperty("$parents",function(){return f.$parentContexts.peek().map(function(a){return a.$data()})}),f.addComputedProperty("$parent",function(){return f.$parentContext.peek().$data()}),f.addComputedProperty("$root",function(){var a=f.$parentContexts.peek();return a.length>0?a[a.length-1].$data():void 0})):e.$parents=[],f},c}();!function(){a.Utilities.markSupportedForProcessing(b.defaultBind)}()}(a.KO||(a.KO={}));a.KO}(WinJS||(WinJS={}));var WinJS;!function(a){!function(b){function c(b){function c(){f=new j;var a=g._array;g._array=d(g),g.notify("_array",g._array,a)}var f,g=new a.Binding.List(b);return g.addEventListener("itemchanged",c),g.addEventListener("iteminserted",c),g.addEventListener("itemmoved",c),g.addEventListener("itemmutated",c),g.addEventListener("itemremoved",c),g.addEventListener("reload",c),g._lastUpdatedStamp=function(){return f},g._array=d(g),g.array=function(){var a=i.currentContext();return a&&e(g,"_array"),g._array},g}function d(b){return b instanceof a.Binding.List?b.map(function(a){return a}):void 0}function e(a,b){var c=i.currentContext();if(c&&c.type==h.TYPE_INITIAL_EVALUATION){var d=c.observableProperty,e=d._observable[d._propertyName],f=new g(a,b),j=e._dependencies||[];j.some(function(a){return a===f})||j.push(f),e._dependencies=j,a.bind(b,e._computedUpdater)}}b.observable=function(b){var c="object"==typeof b?b:new k(b);if(c){var d=a.Binding.as(c);return new f(d)}return c},b.computed=function(a,c,d,e,k){var l=a;if(a&&"object"==typeof a?(d=a||{},l=d.read):(d=d||{},l||(l=d.read)),"function"!=typeof l)throw new Error("Pass a function that returns the value of the computed function.");c=c||d.owner;var m,n,o=function(){return c?l.call(c):l()};e?(m=e,n=k):(m=b.observable(0),n="value");var p,q=m[n];m instanceof f&&m.dispose(n);var r=function(){var a=i.currentContext();if(!a||a.type!=h.TYPE_INITIAL_EVALUATION){var b=o(),c=q._dependencies||[],d=new j(new Date(0));if(c.forEach(function(a){var b=a._observable._lastUpdatedStamp(a._propertyName);b&&d.lessThan(b)&&(d=b)}),m instanceof f){var e=m._lastUpdatedStamp(n);(!e||e.lessThan(d))&&m.setProperty(n,b,d)}else m[n]=b}},s=d.write;if(s&&"function"==typeof s){if(q._computedWriter=function(){var a=i.currentContext();a&&a.type==h.TYPE_WRITER_INITIAL_RUN||(a=new h(h.COMPUTED_WRITER,m._lastUpdatedStamp(n)||j.newStamp()),i.execute(a,function(){c?s.call(c):s()}))},!(m instanceof f))throw new Error("A non-observable destionation does not support writer.");i.execute(new h(h.TYPE_WRITER_INITIAL_RUN),function(){m.bindable().bind(n,q._computedWriter)})}return q._computedUpdater=r,i.execute(new h(h.TYPE_INITIAL_EVALUATION,new g(m,n)),function(){p=o(),m instanceof f?m.setProperty(n,p):m[n]=p}),m==e?p:m},b.observableArray=c,b.getRawArray=d;var f=function(){function a(a){var b=this;this._winjsObservable=a;for(var c=a.backingData;c&&c!==Object.prototype;)Object.keys(c).forEach(function(a){return b._addProperty(a)}),c=Object.getPrototypeOf(c)}return a.prototype.bindable=function(){return this._winjsObservable},a.prototype.bind=function(a,b){return this._winjsObservable.bind(a,b)},a.prototype.unbind=function(a,b){return this._winjsObservable.unbind(a,b)},a.prototype.addComputedProperty=function(a,c,d,e){this.addProperty(a),b.computed(c,d,e,this,a)},a.prototype.addProperty=function(a,b){var c=this._winjsObservable.addProperty(a,b);return this._addProperty(a),c},a.prototype.getProperty=function(a){return e(this,a),this._winjsObservable.getProperty(a)},a.prototype.setProperty=function(a,b,c){var d=(this[a],i.currentContext());if(d&&d.type==h.COMPUTED_WRITER){var e=this._lastUpdatedStamp(a);(!e||e.lessThan(d.upateStamp))&&(this._lastUpdatedStamp(a,d.upateStamp),this._winjsObservable.updateProperty(a,b))}else this._lastUpdatedStamp(a,c||j.newStamp()),this._winjsObservable.updateProperty(a,b)},a.prototype.dispose=function(a){var b=this;if(arguments.length>0){var c=this[a];if(c){if(c._computedUpdater){var d=c._dependencies||[];d.forEach(function(a){a._observable.unbind(a._propertyName,c._computedUpdater)}),c._computedUpdater=null,c._dependencies=[]}c._computedWriter&&(this.unbind(a,c._computedWriter),c._computedUpdater=null)}}else Object.keys(this).forEach(function(a){b.dispose(a)})},a.prototype._lastUpdatedStamp=function(a,b){return this._lastUpdatedStamps=this._lastUpdatedStamps||{},1==arguments.length?this._lastUpdatedStamps[a]:void(arguments.length>1&&(this._lastUpdatedStamps[a]=b))},a.prototype._getObservable=function(){return this},a.prototype._addProperty=function(a){var c=this,d=function(b){return 0==arguments.length?c.getProperty(a):c.setProperty(a,b)};this[a]=d;var e=function(){return c._winjsObservable.getProperty(a)},f=function(d,e,f){b.computed(d,e,f,c,a)},g=function(){c.dispose(a)};return d.peek=e,d.computed=f,d.dispose=g,d},a}(),g=function(){function a(a,b){this._observable=a,this._propertyName=b}return a}(),h=function(){function a(b,c){this.type=b,b==a.TYPE_INITIAL_EVALUATION?this.observableProperty=c:this.upateStamp=c}return a.TYPE_INITIAL_EVALUATION=0,a.TYPE_COMPUTED_UPDATER=1,a.TYPE_WRITER_INITIAL_RUN=2,a.COMPUTED_WRITER=3,a}(),i=function(){function a(){}return a.execute=function(b,c){try{var d=a._currentContext;a._currentContext=b,c()}finally{a._currentContext=d}},a.currentContext=function(){return a._currentContext},a.contextStack=[],a}(),j=function(){function a(a,b){this.timeStamp=a||new Date,this.index=b||0}return a.prototype.lessThan=function(a){return this.timeStamp<a.timeStamp||this.timeStamp<a.timeStamp&&this.index<a.index},a.newStamp=function(){var b=new a;return b.timeStamp==a._lastUpdateStamp.timeStamp&&b.index==a._lastUpdateStamp.index+1,a._lastUpdateStamp=new a(b.timeStamp,b.index),b},a._lastUpdateStamp=new a,a}(),k=function(){function a(a){this.value=a}return a}()}(a.KO||(a.KO={}));a.KO}(WinJS||(WinJS={}));