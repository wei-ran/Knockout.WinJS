var WinJS;!function(a){!function(b){function c(b,c,d){var e=a.Binding.converter(function(a){return a?"":"none"});return e(b,c,d,["style","display"])}function d(b,c,d){return a.Binding.defaultBind(b,c,d,["textContent"])}function e(b,c,d){return a.Binding.defaultBind(b,c,d,["innerHTML"])}function f(b,c,d,e){var f=d.winControl;return f||"WinJS.KO.FlowControl"!=d.getAttribute("data-win-control")||(f=new a.KO.FlowControl(d)),f?(f.type=e,f.source=b,a.Binding.defaultBind(b,c,d,["winControl","data"])):{cancel:function(){}}}function g(a,b,c){return f(a,b,c,"foreach")}function h(a,b,c){return f(a,b,c,"with")}function i(a,b,c){return f(a,b,c,"if")}function j(a,b,c){return f(a,b,c,"ifnot")}function k(b,c,d,e){function f(){var a=d._winjs_ko_eventBind||{};for(var b in a)d.removeEventListener(b,a[b])}var g=x.isObservableDataContext(b)?a.Binding.unwrap(b.$data):b,h=a.Binding.converter(function(a){var b={},c=e(a)||{};for(var h in c){var i=c[h];"function"==typeof i&&(b[h]=function(a){!0===i.apply(g,[g,a])&&a.preventDefault()})}f();for(var h in b)d.addEventListener(h,b[h]);return b}),i=h(b,c,d,["_winjs_ko_eventBind"]);return{cancel:function(){i.cancel(),f()}}}function l(a,b,c){return k(a,b,c,function(a){return{click:a}})}function m(a,b,c){return k(a,b,c,function(a){return a})}function n(a,b,c){return k(a,b,c,function(a){return{submit:a}})}function o(b,c,d){var e=a.Binding.converter(function(a){return!a});return e(b,c,d,["disabled"])}function p(b,c,d){var e=a.Binding.defaultBind(b,c,d,["value"]);return s(b)&&(d.oninput=function(){t(b,c,d.value)}),{cancel:function(){e.cancel(),d.oninput=null}}}function q(b,c,d){function e(a){return a.ownerDocument.activeElement==a}var f=a.Binding.converter(function(a){var f=e(d);return a!=f&&(a?d.focus():d.blur()),s(b)&&(d.onfocus=d.onblur=function(){t(b,c,e(d))}),a}),g=f(b,c,d,["_winjs_ko_hasFocus"]);return{cancel:function(){g.cancel(),d.onfocus=d.onblur=null}}}function r(b,c,d){var e=a.Binding.defaultBind(b,c,d,["checked"]);return s(b)&&(d.onchange=function(){t(b,c,d.checked)}),{cancel:function(){e.cancel(),d.onchange=null}}}function s(b){return a.Binding.unwrap(b)!==b}function t(a,b,c){for(var d=0,e=b.length-1;e>d;d++)if(a=a[b[d]],!a)return;var f=b[b.length-1];a[f]=c}var u={$foreach:g,$if:i,$ifnot:j,$with:h,$event:m,$click:l,$submit:n,$visible:c,$text:d,$html:e,$enable:o,$hasFocus:q,$value:p,$checked:r};b.defaultBind=a.Binding.initializer(function(b,c,d,e){var f=b;if(e.length>0&&w[c[0]]){var g=x.getDataContextFromElement(d);g&&(f=g)}if(e||1==e.length){var h=e[0];if(u[h])return u[h](f,c,d)}return a.Binding.defaultBind(f,c,d,e)});var v=function(){function b(b,c){function d(b){var c=document.createElement("div");c.innerHTML=b.innerHTML;for(var d=b.querySelectorAll("[data-win-bind]"),e=0;e<d.length;e++)d.item(e).attributes.removeNamedItem("data-win-bind");for(;b.hasChildNodes();)b.removeChild(b.lastChild);var f=new a.Binding.Template(c);return f.bindingInitializer=a.KO.defaultBind,c.isDeclarativeControlContainer=!0,f}this.dispose=function(){this._disposeChildren()},c=c||{},b.winControl||(this._data=c.data,this._template=c.tempate||d(b),this._type=c.type,this._source=c.source,this.element=b,b.winControl=this,this.reload())}return b.prototype.reload=function(){var b=this,c=function(a,c,d,e){var f=document.createElement("div");if(c){var g=x.createObservableDataContext(a,d);arguments.length>=4&&g.addProperty("$index",e),f._winjs_ko_dataContext=g}if(a&&b._template.render(a,f),1==f.childElementCount){var h=f.firstElementChild;return f.removeChild(f.firstElementChild),h._winjs_ko_dataContext=g,h}return f},d=function(a,d,e){var f=c(a,d,e);b.element.appendChild(f)};if(this._disposeChildren(),this._template)switch(this._type){case"if":this._data&&d(this._source,!1);break;case"ifnot":this._data||d(this._source,!1);break;case"with":d(this._data,!0,this._source);break;case"foreach":var e=this._source,f=function(d){if(d instanceof Array||d instanceof a.Binding.List){var f=d.map(function(a,d){for(var f=b.element.firstChild;f&&f._winjs_ko_dataItem!=a;)f=f.nextSibling;return f?b.element.removeChild(f):(f=c(a,!0,e,d),f._winjs_ko_dataItem=a),f});b._disposeChildren(),f.forEach(function(a,c){a._winjs_ko_dataContext.$index=c,b.element.appendChild(a)})}};this._data instanceof a.Binding.List&&this._data._array instanceof Array?this._data.bind("_array",f):f(this._data)}},Object.defineProperty(b.prototype,"data",{get:function(){return this._data},set:function(a){a!==this._data&&(this._data=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"template",{get:function(){return this._template},set:function(a){a!==this._template&&(this._template=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"type",{get:function(){return this.type},set:function(a){a!==this._type&&(this._type=a,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"source",{get:function(){return this._source},set:function(a){a!==this._source&&(this._source=a,this.reload())},enumerable:!0,configurable:!0}),b.prototype._disposeChildren=function(){for(;this.element.childElementCount>0;){var a=this.element.lastElementChild;"function"==typeof a.dispose&&a.dispose();var b=a._winjs_ko_dataContext;b&&"function"==typeof b.dispose&&b.dispose(),this.element.removeChild(a)}},b.cctor=function(){a.Utilities.markSupportedForProcessing(b),b.isDeclarativeControlContainer=!0}(),b}();b.FlowControl=v;var w={$parent:!0,$parents:!0,$root:!0,$data:!0,$index:!0,$parentContext:!0,$rawData:!0,$element:!0,$context:!0},x=function(){function c(){}return c.prototype.data=function(b){this.$data=b,this.$rawData=b instanceof a.Binding.List?a.KO.getRawArray(b):a.Binding.unwrap(b)},c.isObservableDataContext=function(b){return b&&a.Binding.unwrap(b)instanceof c},c.getDataContextFromElement=function(a){for(var b=a;b&&!c.isObservableDataContext(b._winjs_ko_dataContext);)b=b.parentElement;return b?b._winjs_ko_dataContext:null},c.createObservableDataContext=function(a,d){var e=new c;e.data(a),d?(e.$parentContexts=[d],e.$parentContext=d):e.$parentContexts=[];var f=b.observable(e);return c.isObservableDataContext(d)?(e.$parentContexts.concat(d.$parentContexts),f.addComputedProperty("$parents",function(){return f.peek("$parentContexts").map(function(a){return a.$data})}),f.addComputedProperty("$parent",function(){return f.peek("$parentContext").$data}),f.addComputedProperty("$root",function(){var a=f.peek("$parentContexts");return a.length>0?a[a.length-1].$data:void 0})):(f.$parents=[d],f.$parent=d,f.$root=d),f},c}();!function(){a.Utilities.markSupportedForProcessing(b.defaultBind)}()}(a.KO||(a.KO={}));a.KO}(WinJS||(WinJS={}));var WinJS;!function(a){!function(b){function c(b){function c(){e=new k;var a=g._array;g._array=d(g),g.notify("_array",g._array,a)}var e,b=b||[],g=new a.Binding.List(b);return g.addEventListener("itemchanged",c),g.addEventListener("iteminserted",c),g.addEventListener("itemmoved",c),g.addEventListener("itemmutated",c),g.addEventListener("itemremoved",c),g.addEventListener("reload",c),g._lastUpdatedStamp=function(){return e},g._array=d(g),Object.defineProperty(g,"array",{get:function(){var a=j.currentContext();return a&&f(g,"_array"),g._array},enumerable:!0,configurable:!0}),g}function d(b){return b instanceof a.Binding.List?b.map(function(a){return a}):void 0}function e(a){a.addComputedProperty=function(a,c,d,e){this.addProperty(a),b.computed(c,d,e,this,a)};var c=a.getProperty;a.getProperty=function(a){return f(this,a),c.call(this,a)};var d=a.updateProperty;a.updateProperty=function(a,b,c){this._lastUpdatedStamp(a,c||k.newStamp()),d.call(this,a,b)};var e=a.setProperty;a.setProperty=function(a,b){var c=this._computedProperty(a);if(c){if(c._computedWriter)return void c._computedWriter(b);throw new Error("Cannot write a value to a computed observable property unless you specify a 'write' option.")}return e.call(this,a,b)},a._removeAllDependencies=function(a){var b=this._computedProperty(a);if(b){var c=b._dependencies||[];c.forEach(function(a){a._observable.unbind(a._propertyName,b._computedUpdater)}),b._dependencies=[]}};var g=a.dispose;a.dispose=function(a){var b=this;if(arguments.length>0){var c=this._computedProperty(a);c&&(c._removeAllDependencies(),c._computedUpdater=null,c._computedWriter=null,delete this._computedProperties[a])}else g&&g.call(this),Object.keys(this).forEach(function(a){b.dispose(a)})},a._lastUpdatedStamps={},a._lastUpdatedStamp=function(a,b){return this._lastUpdatedStamps=this._lastUpdatedStamps||{},1==arguments.length?this._lastUpdatedStamps[a]:void(arguments.length>1&&(this._lastUpdatedStamps[a]=b))},a._computedProperties={},a._computedProperty=function(a){return this._computedProperties[a]},a.peek=function(a){return c.call(this,a)},a.computed=function(a,c,d,e){b.computed(c,d,e,this,a)},a.getDependenciesCount=function(a){var b=this._computedProperty(a);return b&&b._dependencies?b._dependencies.length:0}}function f(a,b){var c=j.currentContext();if(c&&c.type==i.TYPE_COMPUTED_EVALUATIOR){var d=c.observableProperty;if(!d||d._observable===a&&d._propertyName==b)return;var e=d._observable._computedProperty(d._propertyName),f=new g(a,b),h=e._dependencies||[];h.some(function(a){return a===f})||h.push(f),e._dependencies=h}}b.observable=function(b){var c="object"==typeof b?b:new l(b);if(c){var d=a.Binding.as(c);return e(d),d}return c},b.computed=function(a,c,d,e,f){var l=a;if(a&&"object"==typeof a?(d=a||{},l=d.read):(d=d||{},l||(l=d.read)),"function"!=typeof l)throw new Error("Pass a function that returns the value of the computed function.");var m,n;e?(m=e,n=f):(m=b.observable(0),n="value"),c=c||d.owner||m;var o,p=function(){return l.call(c)};m.dispose&&m.dispose(n);var q=new h;m._computedProperties[n]=q;var r=function(){var a=j.currentContext();if(!a||a.type!=i.TYPE_COMPUTED_DEPENDENCY_BIND){q._removeAllDependencies();var b;j.execute(new i(i.TYPE_COMPUTED_EVALUATIOR,new g(m,n)),function(){b=p()});var c=q._dependencies||[];j.execute(new i(i.TYPE_COMPUTED_DEPENDENCY_BIND),function(){c.forEach(function(a){a._observable.bind(a._propertyName,r)})});var d=new k(new Date(0));if(c.forEach(function(a){var b=a._observable._lastUpdatedStamp(a._propertyName);b&&d.lessThan(b)&&(d=b)}),m._lastUpdatedStamp){var e=m._lastUpdatedStamp(n);(!e||e.lessThan(d))&&m.updateProperty(n,b,d)}else m[n]=b;return b}},s=d.write;s&&"function"==typeof s&&(q._computedWriter=function(a){s.call(c,a)}),q._computedUpdater=r,"function"==typeof m._lastUpdatedStamp&&m._lastUpdatedStamp(n,null);r();return m==e?o:m},b.observableArray=c,b.getRawArray=d;var g=function(){function a(a,b){this._observable=a,this._propertyName=b}return a}(),h=function(){function a(){this._dependencies=[]}return a.prototype._removeAllDependencies=function(){var a=this._computedUpdater;this._dependencies.forEach(function(b){b._observable.unbind(b._propertyName,a)}),this._dependencies=[]},a}(),i=function(){function a(b,c){this.type=b,b==a.TYPE_COMPUTED_EVALUATIOR?this.observableProperty=c:this.upateStamp=c}return a.TYPE_COMPUTED_EVALUATIOR=0,a.TYPE_COMPUTED_DEPENDENCY_BIND=1,a.TYPE_WRITER_INITIAL_RUN=2,a.COMPUTED_WRITER=3,a}(),j=function(){function a(){}return a.execute=function(b,c){try{var d=a._currentContext;a._currentContext=b,c()}finally{a._currentContext=d}},a.currentContext=function(){return a._currentContext},a.contextStack=[],a}(),k=function(){function a(a,b){this.timeStamp=a||new Date,this.index=b||0}return a.prototype.lessThan=function(a){return this.timeStamp<a.timeStamp||this.timeStamp<a.timeStamp&&this.index<a.index},a.newStamp=function(){var b=new a;return b.timeStamp==a._lastUpdateStamp.timeStamp&&b.index==a._lastUpdateStamp.index+1,a._lastUpdateStamp=new a(b.timeStamp,b.index),b},a._lastUpdateStamp=new a,a}(),l=function(){function a(a){this.value=a}return a}()}(a.KO||(a.KO={}));a.KO}(WinJS||(WinJS={}));